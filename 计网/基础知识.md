### 1.OSI的七层模型和各自功能

1. 物理层：底层数据传输；如网线、网卡的标准； 数据是**比特流**（Bits）
2. 数据链路层：定义数据的基本格式，如何传输，如何标识 ;  如网卡MAC地址、错误检测和纠正 ; 数据是**帧**（Frames）
3. 网络层：定义IP编址，定义路由功能；如IP协议、路由协议、分组转发等 ; 数据是**包**（Packages）
4. 传输层：端到端传输数据的基本功能；如TCP、UDP、端口号 ; 数据是**tcp报文段**或**udp用户数据报**（Segments）
5. 会话层：控制应用程序之间的会话能力；如不同软件数据分发给不同软件,负责建立、管理和终止会话 ；**数据流**（Data Stream）。
6. 表示层：数据格式标识，基本压缩加密功能。
7. 应用层：各种应用软件，包括Web应用。

### 2.TCP/IP模型

1. **网络接口层（Link Layer）**
   - 功能：负责在相邻网络节点之间传输数据帧。它处理物理地址（如MAC地址）、硬件接口、网络拓扑结构等。
   - 数据单位：帧（Frame）
   - 关键技术：以太网、Wi-Fi、PPP（点对点协议）、网卡驱动等。
2. **网络层（Internet Layer）**
   - 功能：负责数据包从源主机到目的主机的传输和路由选择。它定义了IP地址、路由协议、分组转发等。
   - 数据单位：数据报（Datagram）
   - 关键技术：IP协议、路由器、IP地址、ICMP（Internet Control Message Protocol）、IGMP（Internet Group Management Protocol）等。
3. **传输层（Transport Layer）**
   - 功能：提供端到端的数据传输服务，确保数据的完整性。它处理数据的分段、重组、流量控制和错误检测。
   - 数据单位：段（Segment）（TCP）或数据报（Datagram）（UDP）
   - 关键技术：TCP（传输控制协议）、UDP（用户数据报协议）、端口号等。
4. **应用层（Application Layer）**
   - 功能：为应用软件提供服务，直接为用户的应用进程提供服务。它提供网络服务的接口，如HTTP、FTP、SMTP、DNS等。
   - 数据单位：数据（Data）
   - 关键技术：Web浏览器、电子邮件、文件传输、域名解析、网络管理等。



### 3.一次完整的http请求过程包含哪些



域名解析、发起tcp的3次握手、建立tcp连接后发起http请求、服务器响应返回html代码、浏览器解析代码、渲染给用户



1. **域名解析（DNS Lookup）**
   - 用户在浏览器中输入一个域名（例如：www.example.com）。
   - 浏览器首先检查本地缓存是否有该域名的记录。
   - 如果没有，它会向配置的DNS服务器发送一个查询请求，以获取与域名对应的IP地址。
   - DNS服务器响应查询请求，返回域名对应的IP地址。
2. **建立TCP连接（TCP Handshake）**
   - 浏览器使用得到的IP地址，通过网络层和数据链路层的协议，找到目标服务器。
   - 浏览器发起一个TCP连接请求到服务器的80端口（HTTP默认端口）或443端口（HTTPS默认端口）。
   - 服务器响应请求，与浏览器进行TCP三次握手，建立连接。
3. **发起HTTP请求（HTTP Request）**
   - 一旦TCP连接建立，浏览器通过该连接发送HTTP请求消息给服务器。
   - HTTP请求消息包括请求行（如GET /index.html HTTP/1.1）、请求头（如Host、User-Agent等）、空行以及可能的请求体（如表单数据）。
4. **服务器响应（HTTP Response）**
   - 服务器接收到HTTP请求后，处理请求并生成响应。
   - 服务器通过相同的TCP连接发送HTTP响应消息给浏览器。
   - HTTP响应消息包括状态行（如HTTP/1.1 200 OK）、响应头、空行以及响应体（如HTML内容）。
5. **浏览器解析HTML代码（HTML Parsing）**
   - 浏览器接收到HTTP响应后，开始解析HTML文档。
   - 浏览器解析HTML标签，并根据标签的指示构建DOM树（文档对象模型）。
6. **渲染页面（Rendering）**
   - 浏览器根据DOM树和CSS样式表构建渲染树（Render Tree）。
   - 渲染树用于确定页面上每个元素的布局和样式。
   - 浏览器执行布局（确定元素的位置和大小）和绘制（将元素绘制到屏幕上）过程，最终将渲染的页面展示给用户。
7. **关闭TCP连接（TCP Close）**
   - 页面加载完成后，浏览器和服务器可以关闭TCP连接，释放资源。
   - 在HTTP/1.1中，默认使用持久连接（Connection: keep-alive），允许在同一个TCP连接上发送和接收多个HTTP请求/响应。
   - 在HTTP/2中，一个TCP连接可以同时处理多个并发的请求和响应，进一步提高了效率。



### 4.GET 和 POST 的差异

**1. 请求目的**

- **GET**：用于从服务器检索数据。
- **POST**：用于向服务器提交数据，通常用于创建或更新资源。

**2. 数据传输方式**

- **GET**：数据附加在URL之后，通过查询字符串传递。
- **POST**：数据包含在HTTP请求体中。

**3. 数据大小限制**

- **GET**：数据大小受限于URL长度（通常由浏览器和服务器决定）。
- **POST**：理论上没有数据大小限制。

**4. 安全性**

- **GET**：数据在URL中可见，不适合传输敏感信息。
- **POST**：数据在请求体中传输，相对更安全。

**5. TCP数据包**

- **GET**：通常只产生一个TCP数据包。
- **POST**：通常产生两个TCP数据包（请求头和请求体分开发送）。

**6. 浏览器缓存**

- **GET**：请求通常会被浏览器缓存。
- **POST**：请求通常不会被浏览器缓存。

**7. 幂等性**

- **GET**：是幂等的，多次执行相同GET请求应返回相同结果。
- **POST**：不是幂等的，多次执行相同POST请求可能会导致资源重复创建或更新。

**8. 使用场景**

- **GET**：用于获取数据，如读取数据库记录。
- **POST**：用于创建或修改数据，如向数据库添加新记录。

**9. 其他HTTP方法**

- HTTP协议还定义了其他方法，如PUT、DELETE、HEAD、OPTIONS、TRACE等，它们各自有不同的用途和特点。

**10. 副作用**

- **GET**：不应该有副作用，即不应该改变服务器状态。
- **POST**：通常用于创建或修改资源，因此会有副作用。



### 5.一个tcp可以对应几个http请求

如果维持链接，一个tcp可以对于多个http请求。

http/1.1中，单个tcp同时只能处理一个请求，两个http请求的生命周期不能重叠。

http2中因为Multiplexing(多路复用),多个请求在tcp链接中并发（硬件允许可以并行）进行，原理是将每个请求和响应映射到一个独立的逻辑流，流都有一个唯一的流标识符

### 6. 浏览器对同一host建立tcp的限制

比如chrome最多6个

### 7. 浏览器访问网页的完整过程整理

1. **检查缓存**：
   - 浏览器首先检查是否有已经缓存的资源（如 HTML、CSS、JS、图片等）。如果有缓存且未过期，则直接从缓存中加载页面内容，而不进行网络请求。

2. **检查本机的 `hosts` 文件**：
   - 如果缓存中没有找到资源，浏览器会检查本机的 `hosts` 文件，看看是否有与请求的域名相对应的 IP 地址。如果 `hosts` 文件中有对应的记录，浏览器将使用该 IP 地址。

3. **调用 API 获取 IP 地址**：
   - 如果 `hosts` 文件中没有找到对应的记录，浏览器会通过调用操作系统的 API（如 Linux 下的 `gethostbyname` 函数）来解析域名。

4. **向本地 DNS 服务器发送 DNS 请求**：
   - 如果操作系统没有缓存 IP 地址，DNS 请求会通过 UDP 协议发送到本地的 DNS 服务器，查询域名的 IP 地址。

5. **DNS 递归查询**：
   - 如果本地 DNS 服务器无法解析域名，它会向上层的 DNS 服务器发起递归查询，直到找到根 DNS 服务器或最终的权威 DNS 服务器，获取到域名的 IP 地址。

6. **获得服务器 IP 地址和端口号**：
   - 一旦 DNS 查询成功，浏览器就会得到服务器的 IP 地址以及默认的端口号（HTTP 为 80，HTTPS 为 443）。浏览器会首先尝试通过 HTTP 协议与服务器建立连接。

7. **建立 TCP 连接**：
   - 浏览器使用 Socket 调用来建立与服务器的 TCP 连接。这个过程通过三次握手完成，以确保连接可靠。

8. **检查协议类型并处理重定向**：
   - 如果服务器使用 HTTPS 而不是 HTTP，服务器会返回一个 3xx 开头的重定向响应，指示浏览器使用 HTTPS（即端口号从 80 变为 443）。浏览器会重新建立一个 HTTPS 连接。

9. **建立 HTTPS 连接**：
   - 使用 HTTPS 时，除了 TCP 三次握手之外，还需要进行 SSL/TLS 握手。握手过程中，双方协商使用的加密算法和验证对方的 SSL 证书。这个过程确保数据在传输过程中不会被篡改或窃取。

10. **请求和响应数据**：
    - 在连接建立后，浏览器向服务器发送 HTTP/HTTPS 请求，服务器返回所请求的资源（如 HTML 文件）。浏览器接收响应数据，并开始解析和渲染页面。

11. **页面渲染**：
    - 浏览器接收到页面内容后，开始解析 HTML，并依次加载所需的 CSS、JavaScript 和其他资源（如图片）。同时，浏览器可能会使用 AJAX 等技术异步加载额外的数据。

12. **显示页面**：
    - 最终，浏览器将所有资源渲染为用户可以看到和交互的网页。

**总结**

整个过程从浏览器输入 URL 到页面显示在用户面前，涉及了缓存检查、DNS 解析、TCP 连接、HTTP/HTTPS 协议处理、SSL/TLS 握手、以及页面的解析和渲染等多个步骤。这些步骤协同工作，确保用户能够快速、安全地访问所请求的网页内容。

### 8.DNS负载均衡是什么策略？

**DNS负载均衡**是一种通过DNS服务器来实现流量分发的技术，用于将访问同一域名的请求分配到多个服务器上，以实现负载均衡，从而提高网站的可用性、稳定性和性能。这种策略特别适用于拥有大量用户访问的网站。

**DNS负载均衡的工作原理：**

1. **多个IP地址绑定到同一个域名**：
   - 在DNS服务器上，为同一个域名（主机名）配置多个IP地址。每个IP地址对应一个服务器实例，这些服务器共同承担来自用户的访问请求。

2. **轮询（Round-Robin）策略**：
   - 最常见的策略是轮询法，即DNS服务器在响应每个DNS查询时，按照配置的顺序依次返回不同的IP地址。例如，第一次查询返回IP1，第二次查询返回IP2，以此类推。当所有IP地址返回完毕后，重新从头开始。

3. **地理位置（GeoDNS）策略**：
   - 根据用户的地理位置，DNS服务器选择距离用户最近的服务器IP地址进行返回。这种方法可以减少网络延迟，提供更快的响应时间。

4. **服务器负载策略**：
   - DNS服务器可以根据每台服务器的当前负载情况，优先将请求分配给负载较低的服务器。这可以避免某些服务器因过载而出现性能问题。

5. **随机分配策略**：
   - DNS服务器可以随机选择一个IP地址返回给用户。这种方法可以在某种程度上防止单个服务器过载，但不如负载感知的策略高效。

6. **最少连接策略**：
   - DNS服务器记录每个服务器的当前连接数，并将请求分配给连接数最少的服务器，以平衡负载。

7. **时间依赖策略**：
   - DNS服务器可以基于时间的不同返回不同的IP地址。例如，白天返回一组IP，晚上返回另一组IP，从而动态调整流量分布。

**DNS负载均衡的优势：**

- **扩展性**：能够轻松添加或移除服务器，随着业务需求增长灵活扩展。
- **高可用性**：即使一台服务器宕机，其他服务器也能继续提供服务，减少宕机对用户的影响。
- **性能优化**：通过地理位置策略和负载感知策略，DNS负载均衡可以显著减少响应时间，提高用户体验。
- **简化管理**：DNS负载均衡相对易于配置和管理，因为不需要在每个服务器上进行复杂的配置，所有的负载均衡逻辑都在DNS服务器上实现。

**适用场景：**

- **高访问量网站**：如电商网站、社交平台、新闻门户等，需要处理大量并发访问的应用。
- **全球性服务**：提供全球服务的公司可以通过GeoDNS策略，将用户请求路由到地理位置最近的数据中心。
- **灾难恢复和容灾**：通过DNS负载均衡，可以实现跨地域的容灾机制，当一个数据中心出现故障时，流量可以自动切换到其他可用的数据中心。

**总结：**

DNS负载均衡通过将用户的访问请求分配到不同的服务器上，来实现服务器之间的负载分摊，提高了系统的可用性、稳定性和响应速度。根据具体的应用场景和需求，可以采用不同的负载均衡策略，如轮询、地理位置、负载感知等，以优化用户体验和系统性能。





